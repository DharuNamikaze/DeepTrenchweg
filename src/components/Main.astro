---
import "../pages/_ocean.css";
import { mlConcepts, depthMarkers, zones } from "../data/mlconcepts.js";

function getNodeClass(size: string) {
  if (size === "large") return "node-large";
  if (size === "medium") return "node-medium";
  return "node-small";
}
---

<main>
  <section class="hero-section">
    <div class="title-container">
      <h1>The ML Trench</h1>
      <h2>
        by
        <span>
          <a
            class="hover:underline"
            href="https://abinesh-mathivanan.vercel.app/"
            target="_blank"
            rel="noopener">Beens</a
          >
        </span>
        &
        <span>
          <a
            class="hover:underline"
            href="https://dharuportfolio.netlify.app/"
            target="_blank"
            rel="noopener">Nami</a
          >
        </span>
      </h2>
    </div>
  </section>

  <div class="wave-border"></div>

  <section class="ocean-section">
    <div class="ocean-container">
      {
        zones.map((zone) => (
          <div class="zone-label" style={`top: ${zone.start + 100}px;`}>
            {zone.name}
          </div>
        ))
      }

      {
        depthMarkers.map((depth) => (
          <span class="depth-marker" style={`top: ${depth}px;`}>
            {depth}m
          </span>
        ))
      }

      {
        mlConcepts.map((concept) => {
          const nodeClass = getNodeClass(concept.size);

          return (
            <div
              class={`ml-concept ${nodeClass}`}
              style={`top: ${concept.depth}px;`}
              data-name={concept.name}
              data-depth={String(concept.depth)}
            >
              <div class="concept-node">
                <div class="node-core"></div>
                <div class="node-glow"></div>
              </div>
              
              <span class="concept-name-label">{concept.name}</span>

              <div class="concept-info">
                <h3>{concept.name}</h3>
                <p>{concept.description}</p>
                <div class="meta-row">
                  <span class="concept-category">{concept.category}</span>
                  <a href={concept.link} target="_blank" rel="noopener noreferrer" class="paper-link">
                    Read Paper â†—
                  </a>
                </div>
              </div>
            </div>
          );
        })
      }
    </div>
  </section>
</main>

<script>
  const concepts = document.querySelectorAll(".ml-concept");

  const conceptObserver = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add("visible");
        }
      });
    },
    { threshold: 0.1, rootMargin: "100px" }
  );

  concepts.forEach((concept) => conceptObserver.observe(concept));
</script>